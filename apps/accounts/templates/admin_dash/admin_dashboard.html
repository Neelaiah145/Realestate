{% extends 'admin_base.html' %}

{% block title %}Dashboard | Realestate{% endblock %}

{% block content %}

{% if is_admin %}

<style>
    /* ================= CARD ================= */
    .card {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 40px;
    }

    /* ================= HEADINGS ================= */
    .card-title {
        font-size: 18px;
        font-weight: 600;
        color: #111827;
        margin-bottom: 20px;
    }

    /* ================= FORM LAYOUT ================= */
    .form-row {
        display: flex;
        gap: 24px;
        margin-bottom: 18px;
    }

    .form-group {
        flex: 1;
        position: relative;
        /* üîë REQUIRED for icons */
    }

    /* ================= LABELS ================= */
    .form-group label {
        font-size: 13px;
        font-weight: 500;
        color: #374151;
        margin-bottom: 6px;
        display: block;
    }

    /* ================= INPUTS ================= */
    .form-group input,
    .form-group select {
        width: 100%;
        max-width: 360px;
        height: 42px;
        padding: 0 14px 0 42px;
        /* üëà space for emoji */
        font-size: 14px;
        border: 1px solid #47494a;
        border-radius: 8px;
        background: #ffffff;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .form-group input:focus,
    .form-group select:focus {
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.15);
        outline: none;
    }

    /* ================= INPUT ICON ================= */
    .form-group .icon {
        position: absolute;
        left: 14px;
        top: 38px;
        /* aligns inside input below label */
        font-size: 16px;
        color: #6b7280;
        pointer-events: none;
    }

    /* ================= BUTTON ================= */
    .btn-primary {
        height: 42px;
        padding: 0 32px;
        background: #4f46e5;
        color: #ffffff;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        white-space: nowrap;
        margin-top: 18px;
    }

    .btn-primary:hover {
        background: #4338ca;
    }

    /* ================= TABLE ================= */
    .table-wrap {
        overflow-x: auto;
    }

    .users-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
    }

    .users-table thead tr {
        border-bottom: 1px solid #e5e7eb;
        color: #6b7280;
        text-align: left;
    }

    .users-table th {
        padding-bottom: 12px;
        font-weight: 600;
    }

    .users-table td {
        padding: 14px 0;
    }

    .users-table tbody tr {
        border-bottom: 1px solid #e5e7eb;
    }

    /* ================= BADGES ================= */
    .badge-active {
        padding: 4px 12px;
        font-size: 12px;
        border-radius: 999px;
        background: #dcfce7;
        color: #166534;
    }

    .badge-inactive {
        padding: 4px 12px;
        font-size: 12px;
        border-radius: 999px;
        background: #fee2e2;
        color: #991b1b;
    }

    /* ================= ACTION LINKS ================= */
    .action-link {
        color: #4f46e5;
        text-decoration: none;
        margin-right: 14px;
        font-weight: 500;
    }

    .action-link.delete {
        color: #dc2626;
    }

    .action-link:hover {
        text-decoration: underline;
    }

    /* ===== PHONE INPUT WITH +91 ===== */
    .phone-input {
        position: relative;
    }

    .phone-input .country-code {
        position: absolute;
        left: 42px;
        top: 38px;
        font-size: 14px;
        color: #374151;
        font-weight: 500;
        pointer-events: none;
    }

    .phone-input input {
        padding-left: 78px;
        /* space for icon + +91 */
    }


    /* ================= RESPONSIVE ================= */
    @media (max-width: 768px) {
        .form-row {
            flex-direction: column;
            gap: 16px;
        }

        .form-group input,
        .form-group select {
            max-width: 100%;
        }
    }
/* dark mode theam */




   
</style>

<!-- ================= CREATE USER ================= -->
<div class="card">
    <h4 class="card-title">Create Agent / Associate</h4>

    <form method="post">
        {% csrf_token %}

        <div class="form-row">
            <div class="form-group">
                <label>User Name</label>
                <span class="icon">üë§</span>
                <input name="username" required placeholder="Create Agent / Associate Name">
            </div>

            <div class="form-group">
                <label>E-mail</label>
                <span class="icon">‚úâÔ∏è</span>
                <input name="email" type="email" required placeholder="Enter E-mail">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group phone-input">
                <label>Phone Number</label>
                <span class="icon">üìû</span>
                <span class="country-code">+91</span>
                <input type="tel" name="phone" placeholder="Enter Valid PhoneNumber" pattern="[6-9][0-9]{9}" maxlength="10" required
                    inputmode="numeric">
            </div>


            <div class="form-group">
                <label>Password</label>
                <span class="icon">üîí</span>
                <input name="password" type="password" required placeholder="Create Password">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Role</label>
                <span class="icon">üß©</span>
                <select name="role">
                    <option value="agent">Agent</option>
                    <option value="associate">Associate</option>
                </select>
            </div>

            <div class="form-group">
                <label style="visibility:hidden;">Action</label>
                <button type="submit" class="btn-primary">
                    Create User
                </button>
            </div>
        </div>
    </form>
</div>

<!-- ================= USERS TABLE ================= -->
<div class="card">
    <h4 class="card-title">All Agents & Associates</h4>

    <div class="table-wrap">
        <table class="users-table">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody>
                {% for u in users %}
                <tr>
                    <td><strong>{{ u.username }}</strong></td>
                    <td>{{ u.email }}</td>
                    <td style="text-transform:capitalize;">{{ u.role }}</td>
                    <td>
                        {% if u.is_active %}
                        <span class="badge-active">Active</span>
                        {% else %}
                        <span class="badge-inactive">Inactive</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'toggle-user' u.id %}" class="action-link">
                            {% if u.is_active %}Deactivate{% else %}Activate{% endif %}
                        </a>
                        <a href="{% url 'delete-user' u.id %}" onclick="return confirm('Delete this user?')"
                            class="action-link delete">
                            Delete
                        </a>
                        <a href="#" class="action-link edit">Edit
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" style="text-align:center;color:#6b7280;padding:24px;">
                        No users found
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endif %}

{% endblock %}
